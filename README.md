# –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã: –Ø–Ω–¥–µ–∫—Å –ê—Ñ–∏—à–∞

## 1. –¢–µ–º–∞ –∏ —Ü–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

**–¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞**
–ê–≥—Ä–µ–≥–∞—Ç–æ—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π —Å —Å–∏—Å—Ç–µ–º–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏ –æ–Ω–ª–∞–π–Ω-–ø–æ–∫—É–ø–∫–æ–π –±–∏–ª–µ—Ç–æ–≤ (B2C SaaS).

**–ê–Ω–∞–ª–æ–≥–∏**
- Timepad
- Kassir.ru  
- –Ø–Ω–¥–µ–∫—Å –ê—Ñ–∏—à–∞ (–æ—Ä–∏–≥–∏–Ω–∞–ª)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª MVP**
- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, –¥–∞—Ç–µ, –ª–æ–∫–∞—Ü–∏–∏
- –ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–æ–≤ –æ–Ω–ª–∞–π–Ω
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- –û—Ç–∑—ã–≤—ã —Å –æ—Ü–µ–Ω–∫–∞–º–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π(–æ—Ç 1 –¥–æ 5)
- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

**–ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è**
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ü–æ–∏—Å–∫, –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –ë–∏–ª–µ—Ç—ã, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è)
- –ê–∫—Ç–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –±–∏–ª–µ—Ç–æ–≤ "–Ω–∞ –≥–æ—Ä—è—á–∏—Ö" —Å–æ–±—ã—Ç–∏—è—Ö
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –∏ –≤—ã–¥–∞—á–∏ –±–∏–ª–µ—Ç–æ–≤
- ML-–º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç–∞–º–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π

**–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| MAU | 8,000,000 | [SimilarWeb] + –¥–∞–Ω–Ω—ã–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –Ø–Ω–¥–µ–∫—Å |
| DAU | 1,600,000 | 20% –æ—Ç MAU |
| –ì–µ–æ–≥—Ä–∞—Ñ–∏—è | 85% - –†–æ—Å—Å–∏—è, 10% - –°–ù–ì, 5% - –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω—ã | [SimilarWeb] |
| –û—Å–Ω–æ–≤–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è | 18-45 –ª–µ—Ç, –≥–æ—Ä–æ–¥—Å–∫–∏–µ –∂–∏—Ç–µ–ª–∏ | –†—ã–Ω–æ—á–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è |

## 2. –†–∞—Å—á–µ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏

**–ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ / –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---------|----------|------------------------|
| –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Å—Å–∏–π –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¥–µ–Ω—å | 1.2 | –û—Ü–µ–Ω–∫–∞: –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π 2-3 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é |
| –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–∏ | 8 –º–∏–Ω—É—Ç | –ê–Ω–∞–ª–æ–≥–∏: SimilarWeb (Timepad) |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –Ω–∞ —Å–µ—Å—Å–∏—é | 12 | –û—Ü–µ–Ω–∫–∞: –ø—Ä–æ—Å–º–æ—Ç—Ä 2-3 —Å—Ç—Ä–∞–Ω–∏—Ü —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ + –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è |
| –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–∫—É–ø–∞—é—â–∏—Ö –±–∏–ª–µ—Ç—ã | 5% | –û—Ç—Ä–∞—Å–ª–µ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è event-–∞–≥–≥—Ä–µ–≥–∞—Ç–æ—Ä–æ–≤ |
| –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫ –Ω–∞ –ø–ª–∞—Ç—è—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–µ—Å—è—Ü | 1.5 | –û—Ü–µ–Ω–∫–∞ |
| –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä JSON-–æ—Ç–≤–µ—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è | 15 –ö–ë | –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ —Å—Ç–∞—Ç–∏–∫–∏ |

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏**

### –ü—Ä–∏—Ä–æ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞ 2 –≥–æ–¥–∞)
- **–¢–µ–∫—É—â–∏–π MAU:** 8,000,000
- **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π —Ä–æ—Å—Ç:** 20% –≤ –≥–æ–¥
- **MAU —á–µ—Ä–µ–∑ 1 –≥–æ–¥:** 9,600,000
- **MAU —á–µ—Ä–µ–∑ 2 –≥–æ–¥–∞:** 11,520,000

#### –û–±—ä–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –ö–æ–ª-–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ | –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä | –û–±—â–∏–π –æ–±—ä–µ–º |
|------------|----------------|----------------|-------------|
| –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | 11,520,000 | 5 –ö–ë | 57.6 –ì–ë |
| –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (–∞–∫—Ç–∏–≤–Ω—ã–µ + –∞—Ä—Ö–∏–≤) | 3,000,000 | 50 –ö–ë | 150 –ì–ë |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | 15,000,000 | 500 –ö–ë | 7.5 –¢–ë |
| –û—Ç–∑—ã–≤—ã | 40,000,000 | 2 –ö–ë | 80 –ì–ë |
| –ë–∏–ª–µ—Ç—ã | 38,400,000 | 10 –ö–ë | 384 –ì–ë |
| –ó–∞–∫–∞–∑—ã | 38,400,000 | 5 –ö–ë | 192 –ì–ë |
| **–ò–¢–û–ì–û** | **‚Äî** | **‚Äî** | **~8.4 –¢–ë** |

#### –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫

| –¢–∏–ø —Ç—Ä–∞—Ñ–∏–∫–∞ | –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–ì–ë/–¥–µ–Ω—å) | –ü–∏–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–ì–±–∏—Ç/—Å) |
|-------------|----------------------------|---------------------------|
| –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π | 460.8 –ì–ë/–¥–µ–Ω—å | 42.7 –ì–±–∏—Ç/—Å |
| –û—Ç–∑—ã–≤—ã (—á—Ç–µ–Ω–∏–µ) | 175.8 –ì–ë/–¥–µ–Ω—å | 16.3 –ì–±–∏—Ç/—Å |
| –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã | 4.9 –ì–ë/–¥–µ–Ω—å | 0.45 –ì–±–∏—Ç/—Å |
| –ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–æ–≤ | 1.5 –ì–ë/–¥–µ–Ω—å | 0.14 –ì–±–∏—Ç/—Å |
| –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (CDN) | 36 –ì–ë/–¥–µ–Ω—å | 3.3 –ì–±–∏—Ç/—Å |
| **–ò–¢–û–ì–û –∏—Å—Ö–æ–¥—è—â–∏–π** | **~212 –ì–ë/–¥–µ–Ω—å** | **~19.6 –ì–±–∏—Ç/—Å** |
| **–ò–¢–û–ì–û –≤—Ö–æ–¥—è—â–∏–π** | **~467 –ì–ë/–¥–µ–Ω—å** | **~43.2 –ì–±–∏—Ç/—Å** |

#### RPS (Requests Per Second)

| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –°—Ä–µ–¥–Ω–∏–π RPS | –ü–∏–∫–æ–≤—ã–π RPS (x5) |
|-------------|-------------|------------------|
| GET /events/search (–ø–æ–∏—Å–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π) | 44.4 | 222 |
| GET /events/{id} (–ø—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è) | 267 | 1335 |
| POST /tickets/purchase (–ø–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–∞) | 1.9 | 9.5 |
| GET /recommendations (–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏) | 44.4 | 222 |
| POST /events (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è) | 0.9 | 4.5 |
| **–ò–¢–û–ì–û** | **~358.6 RPS** | **~1793 RPS** |

**–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤**

- **DAU:** 1,600,000
- **–ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π (GET /events/{id}):**
  - –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å: 1,600,000 √ó 1.2 —Å–µ—Å—Å–∏–∏ √ó 12 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤/—Å–µ—Å—Å–∏—é = 23,040,000
  - –°—Ä–µ–¥–Ω–∏–π RPS: 23,040,000 / 86400 —Å–µ–∫ = **266.7 RPS** (–æ–∫—Ä—É–≥–ª–∏–º –¥–æ 267)

- **–ü–æ–∏—Å–∫ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (GET /events/search, GET /recommendations):**
  - –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å: 1,600,000 √ó 1.2 —Å–µ—Å—Å–∏–∏ √ó 2 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ—Å—Å–∏—é = 3,840,000 (–Ω–∞ –∫–∞–∂–¥—ã–π —Ç–∏–ø)
  - –°—Ä–µ–¥–Ω–∏–π RPS: 3,840,000 / 86400 —Å–µ–∫ = **44.4 RPS** (–Ω–∞ –∫–∞–∂–¥—ã–π)

- **–ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–æ–≤ (POST /tickets/purchase):**
  - –ü–æ–∫—É–ø–æ–∫ –≤ –¥–µ–Ω—å: 1,600,000 √ó 5% = 80,000
  - –ó–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–∫—É–ø–∫—É: 80,000 √ó 2 = 160,000 (–∫–æ—Ä–∑–∏–Ω–∞ + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)
  - –°—Ä–µ–¥–Ω–∏–π RPS: 160,000 / 86400 = **1.85 RPS** (–æ–∫—Ä—É–≥–ª–∏–º –¥–æ 1.9)

## 3. –ì–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

#### 3.1. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ –¥–æ–º–µ–Ω–∞–º

- **`api.afisha.ru`** (–æ—Å–Ω–æ–≤–Ω–æ–µ API): –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –ü–æ–∏—Å–∫, –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- **`pay.afisha.ru`** (–ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑): –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π, –≤—ã–ø—É—Å–∫ –±–∏–ª–µ—Ç–æ–≤
- **`cdn.afisha.ru`** (–∫–æ–Ω—Ç–µ–Ω—Ç–Ω–∞—è —Å–µ—Ç—å): –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö assets

#### 3.2. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –î–¶

**–ì–ª–∞–≤–Ω–∞—è –∑–∞–¥–∞—á–∞:** –û–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∏–∑–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –ø–æ–∫—É–ø–∫–µ –±–∏–ª–µ—Ç–æ–≤, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –î–¶:**
- **85% —Ç—Ä–∞—Ñ–∏–∫–∞ (–†–æ—Å—Å–∏—è):** –û—Å–Ω–æ–≤–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
    - **–î–¶-1 (–ú–æ—Å–∫–≤–∞):** –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–≥–∏–æ–Ω
    - **–î–¶-2 (–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥):** –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥ –∏ —á–∞—Å—Ç—å –ï–≤—Ä–æ–ø—ã
    - **–î–¶-3 (–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥):** –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –£—Ä–∞–ª—å—Å–∫–∏–π —Ä–µ–≥–∏–æ–Ω –∏ —á–∞—Å—Ç—å –°–∏–±–∏—Ä–∏
- **10% —Ç—Ä–∞—Ñ–∏–∫–∞ (–°–ù–ì):**
    - **–î–¶-4 (–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω, –ê–ª–º–∞—Ç—ã):** –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –°—Ä–µ–¥–Ω—é—é –ê–∑–∏—é

#### 3.3. –°—Ö–µ–º–∞ DNS –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

–ò—Å–ø–æ–ª—å–∑—É–µ–º **Latency-based (GeoDNS) Routing**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `api.afisha.ru`
- DNS-–ø—Ä–æ–≤–∞–π–¥–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç IP-–∞–¥—Ä–µ—Å —Ç–æ–≥–æ –î–¶, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à—É—é —Å–µ—Ç–µ–≤—É—é –∑–∞–¥–µ—Ä–∂–∫—É
- –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞ –±—É–¥–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –≤ –î–¶-3 (–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥)

#### 3.4. –°—Ö–µ–º–∞ Anycast –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

**Anycast** –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è `cdn.afisha.ru` –∏ `pay.afisha.ru`
- **–î–ª—è CDN:** –û–¥–∏–Ω IP-–∞–¥—Ä–µ—Å –∞–Ω–æ–Ω—Å–∏—Ä—É–µ—Ç—Å—è –≤—Å–µ–º–∏ –î–¶. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–π —É–∑–µ–ª
- **–î–ª—è –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞:** Anycast –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å. –ï—Å–ª–∏ –æ–¥–∏–Ω –î–¶ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ç—Ä–∞—Ñ–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

#### 3.5. –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –º–µ–∂–¥—É –î–¶

- **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —á—Ç–µ–Ω–∏—è:** –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–ª–∏–∂–∞–π—à–∏–º –î–¶
- **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∏:** –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –ø–æ–∫—É–ø–∫—É –±–∏–ª–µ—Ç–æ–≤ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –î–¶ (–ú–æ—Å–∫–≤–∞) –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- **Active-Active:** –í—Å–µ –î–¶ –∞–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã

## 4. –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

#### 4.1. –°—Ö–µ–º–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏

–ò—Å–ø–æ–ª—å–∑—É–µ–º –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å—Ö–µ–º—É –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏

**–£—Ä–æ–≤–µ–Ω—å 1:** L4 Load Balancer (HAProxy) - TCP-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞, SSL Termination  
*(–°—Ö–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è: Active/Active)*  
**–£—Ä–æ–≤–µ–Ω—å 2:** L7 Load Balancer (Nginx Ingress) - HTTP-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ  
*(–°—Ö–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è: N+1)*  
**–£—Ä–æ–≤–µ–Ω—å 3:** Kubernetes Service (kube-proxy) - –í–Ω—É—Ç—Ä–∏–∫–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞  
**–£—Ä–æ–≤–µ–Ω—å 4:** Pods (–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã) - –ü–æ–∏—Å–∫, –ë–∏–ª–µ—Ç—ã, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏...

```
–ò–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí L4 LB ‚Üí L7 LB ‚Üí kube-proxy ‚Üí Pods
```


**–§–æ—Ä–º—É–ª–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è: N+1**
- –ù–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ–¥–∏–Ω —É–∑–µ–ª –±–æ–ª—å—à–µ, —á–µ–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∏–∫–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

#### 4.2. –†–∞—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–≤

**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- **–ü–∏–∫–æ–≤—ã–π RPS:** ~1793 RPS
- **–ü–∏–∫–æ–≤—ã–π —Ç—Ä–∞—Ñ–∏–∫ (–≤—Ö–æ–¥—è—â–∏–π):** ~43.2 –ì–±–∏—Ç/—Å

**–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –¥–ª—è L7-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–≤ (Nginx):**
1. **SSL Termination:** ~10,000 CPS –Ω–∞ 24 CPU
2. **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–µ—Ç–∏:** 10 –ì–±–∏—Ç/—Å –Ω–∞ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**–†–∞—Å—á–µ—Ç –ø–æ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏:**
- –ü–∏–∫–æ–≤—ã–π –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫: ~43.2 –ì–±–∏—Ç/—Å
- –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–¥–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞: 10 –ì–±–∏—Ç/—Å
- **–ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞:** 43.2 / 10 = 4.32 ‚Üí **5 –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞**

**–ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ö–µ–º—É —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è N+1:**
- –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω—É–∂–Ω–æ 5 –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞
- –î–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª—è–µ–º 1 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π
- **–ò—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ L7-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–≤: 6**

–ö–∞–∂–¥—ã–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É —Å 8-16 CPU, 16-32 –ì–ë –û–ó–£ –∏ —Å–µ—Ç–µ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º 10 –ì–±–∏—Ç/—Å.

## 5. –õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –ë–î

![alt text](image.png)

### üìã –¢–∞–±–ª–∏—Ü–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å—É—â–Ω–æ—Å—Ç–µ–π

| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è | –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ | QPS —á—Ç–µ–Ω–∏—è / –∑–∞–ø–∏—Å–∏ |
|---------|------------|---------------|----------------------|-------------------|
| users | –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | id, email, name, avatar_url | ~500 –ë | R: 50k / W: 5k |
| organizers | –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π | id, user_id, company_name, contact_phone | ~300 –ë | R: 10k / W: 1k |
| categories | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π | id, name, parent_id | ~100 –ë | R: 5k / W: 100 |
| venues | –ú–µ—Å—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è | id, name, address, city, coordinates | ~400 –ë | R: 15k / W: 500 |
| events | –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è | id, title, description, dates, prices | ~2 –ö–ë | R: 200k / W: 20k |
| tickets | –ë–∏–ª–µ—Ç—ã | id, event_id, user_id, price, status | ~300 –ë | R: 80k / W: 15k |
| reviews | –û—Ç–∑—ã–≤—ã –∏ –æ—Ü–µ–Ω–∫–∏ | id, event_id, user_id, rating, comment | ~500 –ë | R: 30k / W: 5k |
| user_preferences | –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π | id, user_id, category_id, weight | ~100 –ë | R: 20k / W: 3k |
| search_history | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ | id, user_id, query_text, filters | ~400 –ë | R: 10k / W: 8k |
| image_urls | –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã | id, entity_type, entity_id, image_url, image_type |
| orders | –ó–∞–∫–∞–∑—ã –±–∏–ª–µ—Ç–æ–≤ | id, user_id, total_amount, status, payment_intent_id |

### ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

| –¢–∞–±–ª–∏—Ü–∞ | –ú–æ–¥–µ–ª—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---------|------------------------|-------------|
| users | Strong | –î–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–≥–æ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã |
| organizers | Strong | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞—Ö –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –¥–æ–≤–µ—Ä–∏—è |
| events | Strong | –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –∏ –±–∏–ª–µ—Ç–∞—Ö |
| tickets | Strong | –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –±–∏–ª–µ—Ç–æ–≤ |
| venues | Strong | –ì–µ–æ–¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–æ—á–Ω—ã–º–∏ |
| reviews | Eventual | –û—Ç–∑—ã–≤—ã –º–æ–≥—É—Ç —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π |
| user_preferences | Eventual | –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∫ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ |
| search_history | Eventual | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ –¥–æ–ø—É—Å–∫–∞–µ—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è |

### üîë –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ –∫–ª—é—á–∞–º

| –¢–∞–±–ª–∏—Ü–∞ | –ö–ª—é—á–∏ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|---------|-------------------------|-------------|
| users | id | –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ UUID |
| events | id + city | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≥–æ—Ä–æ–¥–∞–º |
| tickets | event_id | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –±–∏–ª–µ—Ç–æ–≤ –ø–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º |
| reviews | event_id | –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ –ø–æ —Å–æ–±—ã—Ç–∏—è–º |
| venues | city | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç |
| search_history | user_id | –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞ |

## 6. –§–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –ë–î

### 6.1 –í—ã–±–æ—Ä –°–£–ë–î –ø–æ —Ç–∞–±–ª–∏—Ü–∞–º

| –¢–∞–±–ª–∏—Ü–∞ | –°–£–ë–î | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---------|------|-------------|
| users | PostgreSQL | Strong consistency, —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ñ–∏–ª–µ–π |
| organizers | PostgreSQL | –°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ |
| categories | PostgreSQL | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è |
| venues | PostgreSQL + PostGIS | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã |
| events | Cassandra | –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —á—Ç–µ–Ω–∏—è, –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| event_search_index | Elasticsearch | –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫, —Ñ–∞—Å–µ—Ç–Ω—ã–π –ø–æ–∏—Å–∫ |
| image_urls | PostgreSQL + AWS S3 | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ PG, —Ñ–∞–π–ª—ã –≤ S3 + CDN |
| orders | PostgreSQL | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤ |
| tickets | PostgreSQL | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å, —Å–≤—è–∑—å —Å –∑–∞–∫–∞–∑–∞–º–∏ |
| event_ticket_counters | Redis | Atomic –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã, –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø |
| reviews | Cassandra | –í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø–∏—Å–∏ –æ—Ç–∑—ã–≤–æ–≤ |
| user_preferences | Redis | –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π |
| search_history | PostgreSQL | –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ |

### 6.2 –ò–Ω–¥–µ–∫—Å—ã

```sql
-- PostgreSQL –∏–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_organizers_user_id ON organizers(user_id);
CREATE INDEX idx_venues_city ON venues(city);
CREATE INDEX idx_events_organizer ON events(organizer_id);
CREATE INDEX idx_events_category ON events(category_id);
CREATE INDEX idx_events_city_date ON events(city, start_time);
CREATE INDEX idx_tickets_event_user ON tickets(event_id, user_id);
CREATE INDEX idx_tickets_status ON tickets(status);
CREATE INDEX idx_reviews_event_rating ON reviews(event_id, rating);

-- Cassandra –∏–Ω–¥–µ–∫—Å—ã (–≤—Ç–æ—Ä–∏—á–Ω—ã–µ)
CREATE INDEX idx_events_city ON events(city);
CREATE INDEX idx_events_start_time ON events(start_time);
```

### 6.3 –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

| –¢–∞–±–ª–∏—Ü–∞ | –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è | –¶–µ–ª—å |
|---------|------------------------|------|
| events | venue_name, city, category_name | –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –±–µ–∑ JOIN |
| tickets | event_title, event_date, venue_name | –ë—ã—Å—Ç—Ä–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –õ–ö |
| reviews | user_name, event_title | –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ |
| user_preferences | category_names[] | –ë—ã—Å—Ç—Ä—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |

### 6.4 –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ

| –¢–∞–±–ª–∏—Ü–∞ | –¢–∏–ø —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏—è | –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ |
|---------|------------------|----------------|
| users | user_id mod N | PostgreSQL: 1 master + 2 replicas |
| events | city (–≥–µ–æ—à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ) | Cassandra: RF=3, –∫–∞–∂–¥—ã–π —Ä–µ–≥–∏–æ–Ω |
| tickets | event_id mod N | PostgreSQL: —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Å–æ–±—ã—Ç–∏—è–º |
| venues | city | PostgreSQL: –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |
| reviews | event_id mod N | Cassandra: RF=3 |
| search_history | user_id mod N | Elasticsearch: 3 —Ä–µ–ø–ª–∏–∫–∏ –Ω–∞ —à–∞—Ä–¥ |

### 6.5 –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ / –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **PostgreSQL**: `psycopg2` (Python), `HikariCP` (Java)
- **Cassandra**: `cassandra-driver` (Python), `DataStax Java Driver`
- **Redis**: `redis-py`, `Lettuce` (Java)
- **Elasticsearch**: `elasticsearch-py`, `RestHighLevelClient` (Java)
- **AWS S3**: `boto3` (Python), `AWS SDK` (Java)

### 6.6 –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ / –º—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ

- **PostgreSQL**: PgBouncer + HAProxy –¥–ª—è connection pooling
- **Cassandra**: Token-aware load balancing –≤ –¥—Ä–∞–π–≤–µ—Ä–µ
- **Redis**: Redis Cluster —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **Elasticsearch**: Coordinating nodes –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### 6.7 –°—Ö–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

| –°–£–ë–î | –°—Ç—Ä–∞—Ç–µ–≥–∏—è –±—ç–∫–∞–ø–∞ | RTO/RPO |
|------|------------------|----------|
| PostgreSQL | WAL-–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ + pgBackRest | RTO: 15 –º–∏–Ω, RPO: 5 –º–∏–Ω |
| Cassandra | Incremental snapshots + commitlog | RTO: 30 –º–∏–Ω, RPO: 1 —á–∞—Å |
| Redis | RDB snapshots + AOF | RTO: 5 –º–∏–Ω, RPO: 1 –º–∏–Ω |
| Elasticsearch | Snapshot to S3 | RTO: 20 –º–∏–Ω, RPO: 15 –º–∏–Ω |
| AWS S3 | Versioning + Cross-region replication | RTO: 1 –º–∏–Ω, RPO: 0 |

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø–æ–ª–Ω—ã–µ –±—ç–∫–∞–ø—ã –≤ 02:00
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
- WAL-–∞—Ä—Ö–∏–≤—ã –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- Snapshot S3 - –µ–∂–µ—á–∞—Å–Ω–æ

## 7. –ê–ª–≥–æ—Ä–∏—Ç–º—ã

| –ê–ª–≥–æ—Ä–∏—Ç–º | –û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è | –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------------------|-------------------|
| **BM25 + TF-IDF** | –¢–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –≤ Elasticsearch | **TF-IDF** –≤—ã—á–∏—Å–ª—è–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —Ç–µ—Ä–º–∏–Ω–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—Å–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏: —Ç–µ—Ä–º–∏–Ω—ã, —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏, –Ω–æ —Ä–µ–¥–∫–æ –≤ –¥—Ä—É–≥–∏—Ö, –ø–æ–ª—É—á–∞—é—Ç –≤—ã—Å–æ–∫–∏–π –≤–µ—Å. **BM25** —É–ª—É—á—à–∞–µ—Ç TF-IDF, –Ω–æ—Ä–º–∞–ª–∏–∑—É—è –¥–ª–∏–Ω—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –¥–æ–±–∞–≤–ª—è—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤–ª–∏—è–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã —Ç–µ—Ä–º–∏–Ω–æ–≤ –∏ –¥–ª–∏–Ω—ã –ø–æ–ª—è. –§–æ—Ä–º—É–ª–∞: `score = IDF(q) * (TF(q) * (k1 + 1)) / (TF(q) + k1 * (1 - b + b * (–¥–ª–∏–Ω–∞_–¥–æ–∫—É–º–µ–Ω—Ç–∞/—Å—Ä–µ–¥–Ω—è—è_–¥–ª–∏–Ω–∞)))`. **–†–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É:** –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É |
| **Collaborative Filtering + Content-Based Filtering** | –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π | **Collaborative Filtering** —Å—Ç—Ä–æ–∏—Ç –º–∞—Ç—Ä–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å-–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —è–≤–Ω—ã—Ö (–æ—Ü–µ–Ω–∫–∏, –ø–æ–∫—É–ø–∫–∏) –∏ –Ω–µ—è–≤–Ω—ã—Ö (–ø—Ä–æ—Å–º–æ—Ç—Ä—ã, –∫–ª–∏–∫–∏) –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SVD (Singular Value Decomposition) –∏–ª–∏ ALS (Alternating Least Squares) –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Å–µ—â–µ–Ω–∏—è. **Content-Based Filtering** –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞—Ç—Ä–∏–±—É—Ç—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π (–∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ü–µ–Ω–∞, –ª–æ–∫–∞—Ü–∏—è, –≤—Ä–µ–º—è) –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å –ø—Ä–æ—Ñ–∏–ª–µ–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥: `score = Œ± * CF_score + (1-Œ±) * CB_score`, –≥–¥–µ Œ± –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ –∫–∞—á–µ—Å—Ç–≤—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. **–†–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É:** –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –±–µ–∑ —è–≤–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ |
| **Gradient Boosting** | –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–æ–≤–æ–π –≤—ã–¥–∞—á–∏ | –ê–Ω—Å–∞–º–±–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—à–∞—é—â–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤, –≥–¥–µ –∫–∞–∂–¥–æ–µ –ø–æ—Å–ª–µ–¥—É—é—â–µ–µ –¥–µ—Ä–µ–≤–æ –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –æ—à–∏–±–∫–∞—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö. –ü—Ä–∏–∑–Ω–∞–∫–∏: —Ç–µ–∫—Å—Ç–æ–≤–Ω–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å (BM25 score), –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, —Ä–µ–π—Ç–∏–Ω–≥ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è. –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –ª–æ–≥–∞—Ö –∫–ª–∏–∫–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LambdaMART loss function –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ NDCG. **–†–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É:** –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –ø–æ–∫–∞–∑–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π |

**BM25** - –Ω–∞—Ö–æ–¥–∏—Ç –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø–æ —Ç–µ–∫—Å—Ç—É (—á—Ç–æ –∏—Å–∫–∞—Ç—å)  
**Gradient Boosting** - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –ø–æ–∫–∞–∑–∞ (–∫–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å)

## 8. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è | –ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–∞—è —á–∞—Å—Ç—å |
|------------|-------------------|---------------------|
| **Go** | Backend –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ (API, –±–∏–ª–µ—Ç—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏) | –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (1793 RPS), —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏, –Ω–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ |
| **PostgreSQL** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞–∫–∞–∑—ã, –±–∏–ª–µ—Ç—ã, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, —Å–ª–æ–∂–Ω—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã, –Ω–∞–¥–µ–∂–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è |
| **Cassandra** | –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –æ—Ç–∑—ã–≤—ã | –õ–∏–Ω–µ–π–Ω–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, –≤—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| **Redis** | –ö—ç—à —Å–µ—Å—Å–∏–π, —Å—á–µ—Ç—á–∏–∫–∏ –±–∏–ª–µ—Ç–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ | In-memory –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (<1ms), –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å—á–µ—Ç—á–∏–∫–æ–≤, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫—ç—à–∞ |
| **Elasticsearch** | –ü–æ–∏—Å–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ | –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ —Å –º–æ—Ä—Ñ–æ–ª–æ–≥–∏–µ–π, —Ñ–∞—Å–µ—Ç–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º, –±—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫ (<100ms) |
| **AWS S3 + CloudFront** | –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ —Ä–∞–∑–¥–∞—á–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | –ù–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤, –≥–ª–æ–±–∞–ª—å–Ω–∞—è CDN –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |
| **Kubernetes** | –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ | –ê–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫—É, self-healing, rolling deployments –¥–ª—è 24/7 –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ |
| **Nginx** | L7 –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫, SSL termination | –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è API |
| **Apache Kafka** | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π | –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –æ—á–µ—Ä–µ–¥–µ–π, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ |
| **Prometheus + Grafana** | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥ | –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è RPS/–∑–∞–¥–µ—Ä–∂–µ–∫, –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –∞–Ω–æ–º–∞–ª–∏—è—Ö |
| **Docker** | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ | –ï–¥–∏–Ω–∞—è —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏/–ø—Ä–æ–¥–∞–∫—à–Ω, –±—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ, –∏–∑–æ–ª—è—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π |
| **React + TypeScript** | Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å | –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–æ–≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, —Å—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ UI |
| **Two-Phase Commit** | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–∫—É–ø–∫–∏ –±–∏–ª–µ—Ç–æ–≤ | –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π: —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–ª–µ—Ç–æ–≤ ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Üí —Å–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤. Coordinator —É–ø—Ä–∞–≤–ª—è–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ —á–µ—Ä–µ–∑ prepare/commit phases |
| **LRU Cache** | –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Redis | –í—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ –Ω–∞–∏–º–µ–Ω–µ–µ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –ø–∞–º—è—Ç–∏. Double-linked list + hash map –¥–ª—è O(1) –æ–ø–µ—Ä–∞—Ü–∏–π |
| **Token Bucket** | Rate limiting API | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (300/–º–∏–Ω –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è). –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç bucket —Å —Ç–æ–∫–µ–Ω–∞–º–∏, –ø–æ–ø–æ–ª–Ω—è–µ–º—ã–º–∏ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é |
| **Consistent Hashing** | –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Cassandra | –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–∑–ª–∞–º —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞. –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –Ω–æ–¥—ã –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ |
| **Idempotency Key** | –ü–ª–∞—Ç–µ–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ | –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö. –ö–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Redis —Å TTL –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º |

## 9. –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏

## Stateful Graceful Shutdown –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π
1. Load balancer –Ω–∞ –Ω–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
2. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (30 —Å–µ–∫)
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ idempotency keys –≤ Redis
4. –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
5. –§–∏–∫—Å–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ Kafka

## –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å Outbox Pattern
- **Outbox + CDC (Debezium)** ‚Üí Kafka ‚Üí Consumers
- –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ –ë–î –∏ –æ—á–µ—Ä–µ–¥—å
- –°–Ω–∏–∂–µ–Ω–∏–µ latency —Å 2-3—Å –¥–æ 200-300–º—Å
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ consumers

## Graceful Degradation —Å –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π
**–£—Ä–æ–≤–µ–Ω—å 1: Search Service –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω**
- –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é + —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è Cassandra
- –ö—ç—à –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ Redis (5 –º–∏–Ω TTL)

**–£—Ä–æ–≤–µ–Ω—å 2: Payment Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω**
- –†–µ–∂–∏–º "–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è" –±–∏–ª–µ—Ç–æ–≤ –Ω–∞ 15 –º–∏–Ω—É—Ç
- RPS —Å–Ω–∏–∂–∞–µ—Ç—Å—è —Å 9.5 –¥–æ 0.5

**–£—Ä–æ–≤–µ–Ω—å 3: Cassandra –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç**
- –ß—Ç–µ–Ω–∏–µ –∏–∑ Redis –∫—ç—à–∞ (1000 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π)
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –∑–∞–ø–∏—Å–∏ –≤ Kafka

## 10. –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
![alt text](shema.png)

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏
- SimilarWeb: https://www.similarweb.com/ru/website/afisha.yandex.ru/
- –î–∞–Ω–Ω—ã–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –Ø–Ω–¥–µ–∫—Å (—ç–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è)
- –û—Ç—Ä–∞—Å–ª–µ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ event-–∏–Ω–¥—É—Å—Ç—Ä–∏–∏