# –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã: –Ø–Ω–¥–µ–∫—Å –ê—Ñ–∏—à–∞

## 1. –¢–µ–º–∞ –∏ —Ü–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

**–¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞**
–ê–≥—Ä–µ–≥–∞—Ç–æ—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π —Å —Å–∏—Å—Ç–µ–º–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏ –æ–Ω–ª–∞–π–Ω-–ø–æ–∫—É–ø–∫–æ–π –±–∏–ª–µ—Ç–æ–≤ (B2C SaaS).

**–ê–Ω–∞–ª–æ–≥–∏**
- Timepad
- Kassir.ru  
- –Ø–Ω–¥–µ–∫—Å –ê—Ñ–∏—à–∞ (–æ—Ä–∏–≥–∏–Ω–∞–ª)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª MVP**
- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, –¥–∞—Ç–µ, –ª–æ–∫–∞—Ü–∏–∏
- –ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–æ–≤ –æ–Ω–ª–∞–π–Ω
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- –û—Ç–∑—ã–≤—ã —Å –æ—Ü–µ–Ω–∫–∞–º–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π(–æ—Ç 1 –¥–æ 5)
- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

**–ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è**
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ü–æ–∏—Å–∫, –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –ë–∏–ª–µ—Ç—ã, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è)
- –ê–∫—Ç–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –±–∏–ª–µ—Ç–æ–≤ "–Ω–∞ –≥–æ—Ä—è—á–∏—Ö" —Å–æ–±—ã—Ç–∏—è—Ö
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –∏ –≤—ã–¥–∞—á–∏ –±–∏–ª–µ—Ç–æ–≤
- ML-–º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç–∞–º–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π

**–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| MAU | 8,000,000 | [SimilarWeb] + –¥–∞–Ω–Ω—ã–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –Ø–Ω–¥–µ–∫—Å |
| DAU | 1,600,000 | 20% –æ—Ç MAU |
| –ì–µ–æ–≥—Ä–∞—Ñ–∏—è | 85% - –†–æ—Å—Å–∏—è, 10% - –°–ù–ì, 5% - –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω—ã | [SimilarWeb] |
| –û—Å–Ω–æ–≤–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è | 18-45 –ª–µ—Ç, –≥–æ—Ä–æ–¥—Å–∫–∏–µ –∂–∏—Ç–µ–ª–∏ | –†—ã–Ω–æ—á–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è |

## 2. –†–∞—Å—á–µ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏

**–ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ / –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---------|----------|------------------------|
| –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Å—Å–∏–π –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¥–µ–Ω—å | 1.2 | –û—Ü–µ–Ω–∫–∞: –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π 2-3 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é |
| –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–∏ | 8 –º–∏–Ω—É—Ç | –ê–Ω–∞–ª–æ–≥–∏: SimilarWeb (Timepad) |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –Ω–∞ —Å–µ—Å—Å–∏—é | 12 | –û—Ü–µ–Ω–∫–∞: –ø—Ä–æ—Å–º–æ—Ç—Ä 2-3 —Å—Ç—Ä–∞–Ω–∏—Ü —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ + –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è |
| –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–∫—É–ø–∞—é—â–∏—Ö –±–∏–ª–µ—Ç—ã | 5% | –û—Ç—Ä–∞—Å–ª–µ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è event-–∞–≥–≥—Ä–µ–≥–∞—Ç–æ—Ä–æ–≤ |
| –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫ –Ω–∞ –ø–ª–∞—Ç—è—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–µ—Å—è—Ü | 1.5 | –û—Ü–µ–Ω–∫–∞ |
| –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä JSON-–æ—Ç–≤–µ—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è | 15 –ö–ë | –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ —Å—Ç–∞—Ç–∏–∫–∏ |

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏**

### –ü—Ä–∏—Ä–æ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞ 2 –≥–æ–¥–∞)
- **–¢–µ–∫—É—â–∏–π MAU:** 8,000,000
- **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π —Ä–æ—Å—Ç:** 20% –≤ –≥–æ–¥
- **MAU —á–µ—Ä–µ–∑ 1 –≥–æ–¥:** 9,600,000
- **MAU —á–µ—Ä–µ–∑ 2 –≥–æ–¥–∞:** 11,520,000

#### –û–±—ä–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –ö–æ–ª-–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ | –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä | –û–±—â–∏–π –æ–±—ä–µ–º |
|------------|----------------|----------------|-------------|
| –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | 11,520,000 | 5 –ö–ë | 57.6 –ì–ë |
| –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (–∞–∫—Ç–∏–≤–Ω—ã–µ + –∞—Ä—Ö–∏–≤) | 3,000,000 | 50 –ö–ë | 150 –ì–ë |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | 15,000,000 | 500 –ö–ë | 7.5 –¢–ë |
| –û—Ç–∑—ã–≤—ã | 40,000,000 | 2 –ö–ë | 80 –ì–ë |
| –ë–∏–ª–µ—Ç—ã | 38,400,000 | 10 –ö–ë | 384 –ì–ë |
| –ó–∞–∫–∞–∑—ã | 38,400,000 | 5 –ö–ë | 192 –ì–ë |
| **–ò–¢–û–ì–û** | **‚Äî** | **‚Äî** | **~8.4 –¢–ë** |

*–†–∞—Å—á–µ—Ç –±–∏–ª–µ—Ç–æ–≤:* 1,600,000 DAU √ó 5% √ó (1.5 –ø–æ–∫—É–ø–æ–∫/–º–µ—Å / 30 –¥–Ω–µ–π) √ó 730 –¥–Ω–µ–π = 19,200,000 –±–∏–ª–µ—Ç–æ–≤

#### –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫

| –¢–∏–ø —Ç—Ä–∞—Ñ–∏–∫–∞ | –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–ì–ë/–¥–µ–Ω—å) | –ü–∏–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–ì–±–∏—Ç/—Å) |
|-------------|----------------------------|---------------------------|
| –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π | 460.8 –ì–ë/–¥–µ–Ω—å | 42.7 –ì–±–∏—Ç/—Å |
| –û—Ç–∑—ã–≤—ã (—á—Ç–µ–Ω–∏–µ) | 175.8 –ì–ë/–¥–µ–Ω—å | 16.3 –ì–±–∏—Ç/—Å |
| –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã | 4.9 –ì–ë/–¥–µ–Ω—å | 0.45 –ì–±–∏—Ç/—Å |
| –ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–æ–≤ | 1.5 –ì–ë/–¥–µ–Ω—å | 0.14 –ì–±–∏—Ç/—Å |
| –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (CDN) | 36 –ì–ë/–¥–µ–Ω—å | 3.3 –ì–±–∏—Ç/—Å |
| **–ò–¢–û–ì–û –∏—Å—Ö–æ–¥—è—â–∏–π** | **~212 –ì–ë/–¥–µ–Ω—å** | **~19.6 –ì–±–∏—Ç/—Å** |
| **–ò–¢–û–ì–û –≤—Ö–æ–¥—è—â–∏–π** | **~467 –ì–ë/–¥–µ–Ω—å** | **~43.2 –ì–±–∏—Ç/—Å** |

#### RPS (Requests Per Second)

| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | –°—Ä–µ–¥–Ω–∏–π RPS | –ü–∏–∫–æ–≤—ã–π RPS (x5) |
|-------------|-------------|------------------|
| GET /events/search (–ø–æ–∏—Å–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π) | 44.4 | 222 |
| GET /events/{id} (–ø—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è) | 267 | 1335 |
| POST /tickets/purchase (–ø–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–∞) | 1.9 | 9.5 |
| GET /recommendations (–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏) | 44.4 | 222 |
| POST /events (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è) | 0.9 | 4.5 |
| **–ò–¢–û–ì–û** | **~358.6 RPS** | **~1793 RPS** |

**–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤**

- **DAU:** 1,600,000
- **–ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π (GET /events/{id}):**
  - –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å: 1,600,000 √ó 1.2 —Å–µ—Å—Å–∏–∏ √ó 12 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤/—Å–µ—Å—Å–∏—é = 23,040,000
  - –°—Ä–µ–¥–Ω–∏–π RPS: 23,040,000 / 86400 —Å–µ–∫ = **266.7 RPS** (–æ–∫—Ä—É–≥–ª–∏–º –¥–æ 267)

- **–ü–æ–∏—Å–∫ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (GET /events/search, GET /recommendations):**
  - –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å: 1,600,000 √ó 1.2 —Å–µ—Å—Å–∏–∏ √ó 2 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ—Å—Å–∏—é = 3,840,000 (–Ω–∞ –∫–∞–∂–¥—ã–π —Ç–∏–ø)
  - –°—Ä–µ–¥–Ω–∏–π RPS: 3,840,000 / 86400 —Å–µ–∫ = **44.4 RPS** (–Ω–∞ –∫–∞–∂–¥—ã–π)

- **–ü–æ–∫—É–ø–∫–∞ –±–∏–ª–µ—Ç–æ–≤ (POST /tickets/purchase):**
  - –ü–æ–∫—É–ø–æ–∫ –≤ –¥–µ–Ω—å: 1,600,000 √ó 5% = 80,000
  - –ó–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø–æ–∫—É–ø–∫—É: 80,000 √ó 2 = 160,000 (–∫–æ—Ä–∑–∏–Ω–∞ + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)
  - –°—Ä–µ–¥–Ω–∏–π RPS: 160,000 / 86400 = **1.85 RPS** (–æ–∫—Ä—É–≥–ª–∏–º –¥–æ 1.9)

## 3. –ì–ª–æ–±–∞–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

#### 3.1. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ –¥–æ–º–µ–Ω–∞–º

- **`api.afisha.ru`** (–æ—Å–Ω–æ–≤–Ω–æ–µ API): –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –ü–æ–∏—Å–∫, –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- **`pay.afisha.ru`** (–ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑): –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π, –≤—ã–ø—É—Å–∫ –±–∏–ª–µ—Ç–æ–≤
- **`cdn.afisha.ru`** (–∫–æ–Ω—Ç–µ–Ω—Ç–Ω–∞—è —Å–µ—Ç—å): –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö assets

#### 3.2. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –î–¶

**–ì–ª–∞–≤–Ω–∞—è –∑–∞–¥–∞—á–∞:** –û–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∏–∑–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –ø–æ–∫—É–ø–∫–µ –±–∏–ª–µ—Ç–æ–≤, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –î–¶:**
- **85% —Ç—Ä–∞—Ñ–∏–∫–∞ (–†–æ—Å—Å–∏—è):** –û—Å–Ω–æ–≤–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
    - **–î–¶-1 (–ú–æ—Å–∫–≤–∞):** –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–≥–∏–æ–Ω
    - **–î–¶-2 (–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥):** –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥ –∏ —á–∞—Å—Ç—å –ï–≤—Ä–æ–ø—ã
    - **–î–¶-3 (–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥):** –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –£—Ä–∞–ª—å—Å–∫–∏–π —Ä–µ–≥–∏–æ–Ω –∏ —á–∞—Å—Ç—å –°–∏–±–∏—Ä–∏
- **10% —Ç—Ä–∞—Ñ–∏–∫–∞ (–°–ù–ì):**
    - **–î–¶-4 (–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω, –ê–ª–º–∞—Ç—ã):** –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –°—Ä–µ–¥–Ω—é—é –ê–∑–∏—é

#### 3.3. –°—Ö–µ–º–∞ DNS –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

–ò—Å–ø–æ–ª—å–∑—É–µ–º **Latency-based (GeoDNS) Routing**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `api.afisha.ru`
- DNS-–ø—Ä–æ–≤–∞–π–¥–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç IP-–∞–¥—Ä–µ—Å —Ç–æ–≥–æ –î–¶, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à—É—é —Å–µ—Ç–µ–≤—É—é –∑–∞–¥–µ—Ä–∂–∫—É
- –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞ –±—É–¥–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –≤ –î–¶-3 (–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥)

#### 3.4. –°—Ö–µ–º–∞ Anycast –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

**Anycast** –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è `cdn.afisha.ru` –∏ `pay.afisha.ru`
- **–î–ª—è CDN:** –û–¥–∏–Ω IP-–∞–¥—Ä–µ—Å –∞–Ω–æ–Ω—Å–∏—Ä—É–µ—Ç—Å—è –≤—Å–µ–º–∏ –î–¶. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–π —É–∑–µ–ª
- **–î–ª—è –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —à–ª—é–∑–∞:** Anycast –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å. –ï—Å–ª–∏ –æ–¥–∏–Ω –î–¶ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Ç—Ä–∞—Ñ–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

#### 3.5. –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –º–µ–∂–¥—É –î–¶

- **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —á—Ç–µ–Ω–∏—è:** –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–ª–∏–∂–∞–π—à–∏–º –î–¶
- **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∏:** –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –ø–æ–∫—É–ø–∫—É –±–∏–ª–µ—Ç–æ–≤ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –î–¶ (–ú–æ—Å–∫–≤–∞) –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- **Active-Active:** –í—Å–µ –î–¶ –∞–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã

## 4. –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

#### 4.1. –°—Ö–µ–º–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏

–ò—Å–ø–æ–ª—å–∑—É–µ–º –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å—Ö–µ–º—É –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏

**–£—Ä–æ–≤–µ–Ω—å 1:** L4 Load Balancer (HAProxy) - TCP-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞, SSL Termination  
*(–°—Ö–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è: Active/Active)*  
**–£—Ä–æ–≤–µ–Ω—å 2:** L7 Load Balancer (Nginx Ingress) - HTTP-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ  
*(–°—Ö–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è: N+1)*  
**–£—Ä–æ–≤–µ–Ω—å 3:** Kubernetes Service (kube-proxy) - –í–Ω—É—Ç—Ä–∏–∫–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞  
**–£—Ä–æ–≤–µ–Ω—å 4:** Pods (–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã) - –ü–æ–∏—Å–∫, –ë–∏–ª–µ—Ç—ã, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏...

```
–ò–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí L4 LB ‚Üí L7 LB ‚Üí kube-proxy ‚Üí Pods
```


**–§–æ—Ä–º—É–ª–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è: N+1**
- –ù–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ–¥–∏–Ω —É–∑–µ–ª –±–æ–ª—å—à–µ, —á–µ–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∏–∫–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

#### 4.2. –†–∞—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–≤

**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- **–ü–∏–∫–æ–≤—ã–π RPS:** ~1793 RPS
- **–ü–∏–∫–æ–≤—ã–π —Ç—Ä–∞—Ñ–∏–∫ (–≤—Ö–æ–¥—è—â–∏–π):** ~32.4 –ì–±–∏—Ç/—Å

**–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –¥–ª—è L7-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–≤ (Nginx):**
1. **SSL Termination:** ~10,000 CPS –Ω–∞ 24 CPU
2. **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–µ—Ç–∏:** 10 –ì–±–∏—Ç/—Å –Ω–∞ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**–†–∞—Å—á–µ—Ç –ø–æ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏:**
- –ü–∏–∫–æ–≤—ã–π –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫: ~32.4 –ì–±–∏—Ç/—Å
- –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–¥–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞: 10 –ì–±–∏—Ç/—Å
- **–ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞:** 32.4 / 10 = 3.24 ‚Üí **4 –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞**

**–ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ö–µ–º—É —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è N+1:**
- –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω—É–∂–Ω–æ 4 –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞
- –î–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª—è–µ–º 1 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π
- **–ò—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ L7-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–≤: 5**

–ö–∞–∂–¥—ã–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É —Å 8-16 CPU, 16-32 –ì–ë –û–ó–£ –∏ —Å–µ—Ç–µ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º 10 –ì–±–∏—Ç/—Å.

## 5. –õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –ë–î

![alt text](image.png)

### üìã –¢–∞–±–ª–∏—Ü–∞ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å—É—â–Ω–æ—Å—Ç–µ–π

| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è | –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ | QPS —á—Ç–µ–Ω–∏—è / –∑–∞–ø–∏—Å–∏ |
|---------|------------|---------------|----------------------|-------------------|
| users | –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | id, email, name, avatar_url | ~500 –ë | R: 50k / W: 5k |
| organizers | –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π | id, user_id, company_name, contact_phone | ~300 –ë | R: 10k / W: 1k |
| categories | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π | id, name, parent_id | ~100 –ë | R: 5k / W: 100 |
| venues | –ú–µ—Å—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è | id, name, address, city, coordinates | ~400 –ë | R: 15k / W: 500 |
| events | –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è | id, title, description, dates, prices | ~2 –ö–ë | R: 200k / W: 20k |
| event_images | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π | id, event_id, image_url, is_main | ~200 –ë | R: 100k / W: 10k |
| tickets | –ë–∏–ª–µ—Ç—ã | id, event_id, user_id, price, status | ~300 –ë | R: 80k / W: 15k |
| reviews | –û—Ç–∑—ã–≤—ã –∏ –æ—Ü–µ–Ω–∫–∏ | id, event_id, user_id, rating, comment | ~500 –ë | R: 30k / W: 5k |
| user_preferences | –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π | id, user_id, category_id, weight | ~100 –ë | R: 20k / W: 3k |
| search_history | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ | id, user_id, query_text, filters | ~400 –ë | R: 10k / W: 8k |

### ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

| –¢–∞–±–ª–∏—Ü–∞ | –ú–æ–¥–µ–ª—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---------|------------------------|-------------|
| users | Strong | –î–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–≥–æ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã |
| organizers | Strong | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞—Ö –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –¥–æ–≤–µ—Ä–∏—è |
| events | Strong | –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –∏ –±–∏–ª–µ—Ç–∞—Ö |
| tickets | Strong | –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –±–∏–ª–µ—Ç–æ–≤ |
| venues | Strong | –ì–µ–æ–¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–æ—á–Ω—ã–º–∏ |
| reviews | Eventual | –û—Ç–∑—ã–≤—ã –º–æ–≥—É—Ç —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π |
| user_preferences | Eventual | –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∫ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ |
| search_history | Eventual | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ –¥–æ–ø—É—Å–∫–∞–µ—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è |

### üîë –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ –∫–ª—é—á–∞–º

| –¢–∞–±–ª–∏—Ü–∞ | –ö–ª—é—á–∏ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|---------|-------------------------|-------------|
| users | id | –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ UUID |
| events | id + city | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≥–æ—Ä–æ–¥–∞–º |
| tickets | event_id | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –±–∏–ª–µ—Ç–æ–≤ –ø–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º |
| reviews | event_id | –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ –ø–æ —Å–æ–±—ã—Ç–∏—è–º |
| venues | city | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç |
| search_history | user_id | –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞ |

## 6. –§–∏–∑–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –ë–î

### 6.1 –í—ã–±–æ—Ä –°–£–ë–î –ø–æ —Ç–∞–±–ª–∏—Ü–∞–º

| –¢–∞–±–ª–∏—Ü–∞ | –°–£–ë–î | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---------|------|-------------|
| users | PostgreSQL | Strong consistency, —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ñ–∏–ª–µ–π |
| organizers | PostgreSQL | –°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ |
| categories | PostgreSQL | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è |
| venues | PostgreSQL + PostGIS | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã |
| events | Cassandra | –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ —á—Ç–µ–Ω–∏—è, –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| event_search_index | Elasticsearch | –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫, —Ñ–∞—Å–µ—Ç–Ω—ã–π –ø–æ–∏—Å–∫ |
| image_urls | PostgreSQL + AWS S3 | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ PG, —Ñ–∞–π–ª—ã –≤ S3 + CDN |
| orders | PostgreSQL | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤ |
| tickets | PostgreSQL | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å, —Å–≤—è–∑—å —Å –∑–∞–∫–∞–∑–∞–º–∏ |
| event_ticket_counters | Redis | Atomic –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç—ã, –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø |
| reviews | Cassandra | –í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø–∏—Å–∏ –æ—Ç–∑—ã–≤–æ–≤ |
| user_preferences | Redis | –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π |
| search_history | PostgreSQL | –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ |

### 6.2 –ò–Ω–¥–µ–∫—Å—ã

```sql
-- PostgreSQL –∏–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_organizers_user_id ON organizers(user_id);
CREATE INDEX idx_venues_city ON venues(city);
CREATE INDEX idx_events_organizer ON events(organizer_id);
CREATE INDEX idx_events_category ON events(category_id);
CREATE INDEX idx_events_city_date ON events(city, start_time);
CREATE INDEX idx_tickets_event_user ON tickets(event_id, user_id);
CREATE INDEX idx_tickets_status ON tickets(status);
CREATE INDEX idx_reviews_event_rating ON reviews(event_id, rating);

-- Cassandra –∏–Ω–¥–µ–∫—Å—ã (–≤—Ç–æ—Ä–∏—á–Ω—ã–µ)
CREATE INDEX idx_events_city ON events(city);
CREATE INDEX idx_events_start_time ON events(start_time);
```

### 6.3 –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

| –¢–∞–±–ª–∏—Ü–∞ | –î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è | –¶–µ–ª—å |
|---------|------------------------|------|
| events | venue_name, city, category_name | –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –±–µ–∑ JOIN |
| tickets | event_title, event_date, venue_name | –ë—ã—Å—Ç—Ä–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –õ–ö |
| reviews | user_name, event_title | –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ |
| user_preferences | category_names[] | –ë—ã—Å—Ç—Ä—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |

### 6.4 –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ

| –¢–∞–±–ª–∏—Ü–∞ | –¢–∏–ø —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏—è | –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ |
|---------|------------------|----------------|
| users | user_id mod N | PostgreSQL: 1 master + 2 replicas |
| events | city (–≥–µ–æ—à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ) | Cassandra: RF=3, –∫–∞–∂–¥—ã–π —Ä–µ–≥–∏–æ–Ω |
| tickets | event_id mod N | PostgreSQL: —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Å–æ–±—ã—Ç–∏—è–º |
| venues | city | PostgreSQL: –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |
| reviews | event_id mod N | Cassandra: RF=3 |
| search_history | user_id mod N | Elasticsearch: 3 —Ä–µ–ø–ª–∏–∫–∏ –Ω–∞ —à–∞—Ä–¥ |

### 6.5 –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ / –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **PostgreSQL**: `psycopg2` (Python), `HikariCP` (Java)
- **Cassandra**: `cassandra-driver` (Python), `DataStax Java Driver`
- **Redis**: `redis-py`, `Lettuce` (Java)
- **Elasticsearch**: `elasticsearch-py`, `RestHighLevelClient` (Java)
- **AWS S3**: `boto3` (Python), `AWS SDK` (Java)

### 6.6 –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ / –º—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ

- **PostgreSQL**: PgBouncer + HAProxy –¥–ª—è connection pooling
- **Cassandra**: Token-aware load balancing –≤ –¥—Ä–∞–π–≤–µ—Ä–µ
- **Redis**: Redis Cluster —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **Elasticsearch**: Coordinating nodes –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### 6.7 –°—Ö–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

| –°–£–ë–î | –°—Ç—Ä–∞—Ç–µ–≥–∏—è –±—ç–∫–∞–ø–∞ | RTO/RPO |
|------|------------------|----------|
| PostgreSQL | WAL-–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ + pgBackRest | RTO: 15 –º–∏–Ω, RPO: 5 –º–∏–Ω |
| Cassandra | Incremental snapshots + commitlog | RTO: 30 –º–∏–Ω, RPO: 1 —á–∞—Å |
| Redis | RDB snapshots + AOF | RTO: 5 –º–∏–Ω, RPO: 1 –º–∏–Ω |
| Elasticsearch | Snapshot to S3 | RTO: 20 –º–∏–Ω, RPO: 15 –º–∏–Ω |
| AWS S3 | Versioning + Cross-region replication | RTO: 1 –º–∏–Ω, RPO: 0 |

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø–æ–ª–Ω—ã–µ –±—ç–∫–∞–ø—ã –≤ 02:00
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
- WAL-–∞—Ä—Ö–∏–≤—ã –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- Snapshot S3 - –µ–∂–µ—á–∞—Å–Ω–æ

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏
- SimilarWeb: https://www.similarweb.com/ru/website/afisha.yandex.ru/
- –î–∞–Ω–Ω—ã–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã –Ø–Ω–¥–µ–∫—Å (—ç–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è)
- –û—Ç—Ä–∞—Å–ª–µ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ event-–∏–Ω–¥—É—Å—Ç—Ä–∏–∏